{
  "actions": [],
  "extmarks": [
    [
      1,
      1,
      0,
      {
        "ns_id": 3,
        "priority": 10,
        "right_gravity": true,
        "virt_text": [
          [
            " ",
            "OpencodeMessageRoleAssistant"
          ],
          [
            " "
          ],
          [
            "PLAN",
            "OpencodeMessageRoleAssistant"
          ],
          [
            " claude-sonnet-4.5",
            "OpencodeHint"
          ],
          [
            " (2025-10-16 04:27:36)",
            "OpencodeHint"
          ],
          [
            " [msg_9eb45fbe60020xE560OGH3Vdoo]",
            "OpencodeHint"
          ]
        ],
        "virt_text_hide": false,
        "virt_text_pos": "win_col",
        "virt_text_repeat_linebreak": false,
        "virt_text_win_col": -3
      }
    ],
    [
      2,
      5,
      0,
      {
        "ns_id": 3,
        "priority": 4096,
        "right_gravity": true,
        "virt_text": [
          [
            "▌",
            "OpencodeToolBorder"
          ]
        ],
        "virt_text_hide": false,
        "virt_text_pos": "win_col",
        "virt_text_repeat_linebreak": true,
        "virt_text_win_col": -1
      }
    ],
    [
      3,
      6,
      0,
      {
        "ns_id": 3,
        "priority": 4096,
        "right_gravity": true,
        "virt_text": [
          [
            "▌",
            "OpencodeToolBorder"
          ]
        ],
        "virt_text_hide": false,
        "virt_text_pos": "win_col",
        "virt_text_repeat_linebreak": true,
        "virt_text_win_col": -1
      }
    ],
    [
      4,
      7,
      0,
      {
        "ns_id": 3,
        "priority": 4096,
        "right_gravity": true,
        "virt_text": [
          [
            "▌",
            "OpencodeToolBorder"
          ]
        ],
        "virt_text_hide": false,
        "virt_text_pos": "win_col",
        "virt_text_repeat_linebreak": true,
        "virt_text_win_col": -1
      }
    ],
    [
      5,
      8,
      0,
      {
        "ns_id": 3,
        "priority": 4096,
        "right_gravity": true,
        "virt_text": [
          [
            "▌",
            "OpencodeToolBorder"
          ]
        ],
        "virt_text_hide": false,
        "virt_text_pos": "win_col",
        "virt_text_repeat_linebreak": true,
        "virt_text_win_col": -1
      }
    ],
    [
      6,
      9,
      0,
      {
        "ns_id": 3,
        "priority": 4096,
        "right_gravity": true,
        "virt_text": [
          [
            "▌",
            "OpencodeToolBorder"
          ]
        ],
        "virt_text_hide": false,
        "virt_text_pos": "win_col",
        "virt_text_repeat_linebreak": true,
        "virt_text_win_col": -1
      }
    ],
    [
      7,
      10,
      0,
      {
        "ns_id": 3,
        "priority": 4096,
        "right_gravity": true,
        "virt_text": [
          [
            "▌",
            "OpencodeToolBorder"
          ]
        ],
        "virt_text_hide": false,
        "virt_text_pos": "win_col",
        "virt_text_repeat_linebreak": true,
        "virt_text_win_col": -1
      }
    ],
    [
      8,
      13,
      0,
      {
        "ns_id": 3,
        "priority": 10,
        "right_gravity": true,
        "virt_text": [
          [
            " ",
            "OpencodeMessageRoleSystem"
          ],
          [
            " "
          ],
          [
            "SYSTEM",
            "OpencodeMessageRoleSystem"
          ],
          [
            "",
            "OpencodeHint"
          ],
          [
            "",
            "OpencodeHint"
          ],
          [
            " [permission-display-message]",
            "OpencodeHint"
          ]
        ],
        "virt_text_hide": false,
        "virt_text_pos": "win_col",
        "virt_text_repeat_linebreak": false,
        "virt_text_win_col": -3
      }
    ],
    [
      9,
      15,
      0,
      {
        "line_hl_group": "OpencodePermissionTitle",
        "ns_id": 3,
        "priority": 4096,
        "right_gravity": true
      }
    ],
    [
      10,
      15,
      0,
      {
        "ns_id": 3,
        "priority": 4096,
        "right_gravity": true,
        "virt_text": [
          [
            "▌",
            "OpencodePermissionBorder"
          ]
        ],
        "virt_text_hide": false,
        "virt_text_pos": "win_col",
        "virt_text_repeat_linebreak": true,
        "virt_text_win_col": -2
      }
    ],
    [
      11,
      16,
      0,
      {
        "ns_id": 3,
        "priority": 4096,
        "right_gravity": true,
        "virt_text": [
          [
            "▌",
            "OpencodePermissionBorder"
          ]
        ],
        "virt_text_hide": false,
        "virt_text_pos": "win_col",
        "virt_text_repeat_linebreak": true,
        "virt_text_win_col": -2
      }
    ],
    [
      12,
      17,
      0,
      {
        "ns_id": 3,
        "priority": 4096,
        "right_gravity": true,
        "virt_text": [
          [
            "▌",
            "OpencodePermissionBorder"
          ]
        ],
        "virt_text_hide": false,
        "virt_text_pos": "win_col",
        "virt_text_repeat_linebreak": true,
        "virt_text_win_col": -2
      }
    ],
    [
      13,
      18,
      0,
      {
        "ns_id": 3,
        "priority": 4096,
        "right_gravity": true,
        "virt_text": [
          [
            "▌",
            "OpencodePermissionBorder"
          ]
        ],
        "virt_text_hide": false,
        "virt_text_pos": "win_col",
        "virt_text_repeat_linebreak": true,
        "virt_text_win_col": -2
      }
    ],
    [
      14,
      19,
      0,
      {
        "ns_id": 3,
        "priority": 4096,
        "right_gravity": true,
        "virt_text": [
          [
            "▌",
            "OpencodePermissionBorder"
          ]
        ],
        "virt_text_hide": false,
        "virt_text_pos": "win_col",
        "virt_text_repeat_linebreak": true,
        "virt_text_win_col": -2
      }
    ],
    [
      15,
      20,
      0,
      {
        "ns_id": 3,
        "priority": 4096,
        "right_gravity": true,
        "virt_text": [
          [
            "▌",
            "OpencodePermissionBorder"
          ]
        ],
        "virt_text_hide": false,
        "virt_text_pos": "win_col",
        "virt_text_repeat_linebreak": true,
        "virt_text_win_col": -2
      }
    ],
    [
      16,
      21,
      0,
      {
        "ns_id": 3,
        "priority": 4096,
        "right_gravity": true,
        "virt_text": [
          [
            "▌",
            "OpencodePermissionBorder"
          ]
        ],
        "virt_text_hide": false,
        "virt_text_pos": "win_col",
        "virt_text_repeat_linebreak": true,
        "virt_text_win_col": -2
      }
    ],
    [
      17,
      22,
      0,
      {
        "ns_id": 3,
        "priority": 4096,
        "right_gravity": true,
        "virt_text": [
          [
            "▌",
            "OpencodePermissionBorder"
          ]
        ],
        "virt_text_hide": false,
        "virt_text_pos": "win_col",
        "virt_text_repeat_linebreak": true,
        "virt_text_win_col": -2
      }
    ],
    [
      18,
      23,
      0,
      {
        "line_hl_group": "OpencodeDialogOptionHover",
        "ns_id": 3,
        "priority": 4096,
        "right_gravity": true
      }
    ],
    [
      19,
      23,
      0,
      {
        "ns_id": 3,
        "priority": 4096,
        "right_gravity": true,
        "virt_text": [
          [
            "▌",
            "OpencodePermissionBorder"
          ]
        ],
        "virt_text_hide": false,
        "virt_text_pos": "win_col",
        "virt_text_repeat_linebreak": true,
        "virt_text_win_col": -2
      }
    ],
    [
      20,
      23,
      2,
      {
        "ns_id": 3,
        "priority": 4096,
        "right_gravity": true,
        "virt_text": [
          [
            "› ",
            "OpencodeDialogOptionHover"
          ]
        ],
        "virt_text_hide": false,
        "virt_text_pos": "overlay",
        "virt_text_repeat_linebreak": false
      }
    ],
    [
      21,
      24,
      0,
      {
        "ns_id": 3,
        "priority": 4096,
        "right_gravity": true,
        "virt_text": [
          [
            "▌",
            "OpencodePermissionBorder"
          ]
        ],
        "virt_text_hide": false,
        "virt_text_pos": "win_col",
        "virt_text_repeat_linebreak": true,
        "virt_text_win_col": -2
      }
    ],
    [
      22,
      25,
      0,
      {
        "ns_id": 3,
        "priority": 4096,
        "right_gravity": true,
        "virt_text": [
          [
            "▌",
            "OpencodePermissionBorder"
          ]
        ],
        "virt_text_hide": false,
        "virt_text_pos": "win_col",
        "virt_text_repeat_linebreak": true,
        "virt_text_win_col": -2
      }
    ],
    [
      23,
      26,
      0,
      {
        "ns_id": 3,
        "priority": 4096,
        "right_gravity": true,
        "virt_text": [
          [
            "▌",
            "OpencodePermissionBorder"
          ]
        ],
        "virt_text_hide": false,
        "virt_text_pos": "win_col",
        "virt_text_repeat_linebreak": true,
        "virt_text_win_col": -2
      }
    ],
    [
      24,
      27,
      0,
      {
        "ns_id": 3,
        "priority": 4096,
        "right_gravity": true,
        "virt_text": [
          [
            "▌",
            "OpencodePermissionBorder"
          ]
        ],
        "virt_text_hide": false,
        "virt_text_pos": "win_col",
        "virt_text_repeat_linebreak": true,
        "virt_text_win_col": -2
      }
    ]
  ],
  "lines": [
    "----",
    "",
    "",
    "Perfect! Now I understand how it works. The message headers have extmarks with `virt_text` where the first element contains the icon (either `header_user` or `header_assistant`). Let me check the output_window module to understand the extmark namespace:",
    "",
    "**  run** `Find extmark namespace usage`",
    "",
    "`````bash",
    "> rg \"nvim_buf_get_extmarks|ns_id\" /Users/cam/Dev/neovim-dev/opencode.nvim/lua/opencode/ui/output_window.lua -B 2 -A 2",
    "",
    "`````",
    "",
    "----",
    "",
    "",
    "  Permission Required",
    "",
    "  *bash* Find extmark namespace usage",
    "",
    "```bash",
    "rg \"nvim_buf_get_extmarks|ns_id\" /Users/cam/Dev/neovim-dev/opencode.nvim/lua/opencode/ui/output_window.lua -B 2 -A 2",
    "```",
    "",
    "    1. Allow once ",
    "    2. Reject",
    "    3. Allow always",
    "",
    "Navigate: `j`/`k` or `↑`/`↓`  Select: `<CR>` or `1-3`",
    "",
    ""
  ],
  "timestamp": 1770748770
}